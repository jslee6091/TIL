### Linux

- 리눅스 운영체제는 무료이고 풍부한 미들웨어 및 장치 드라이버가 있어 임베디드 제품 개발에 이용되고 있다.
- Linux 구조
  - 사용자 모드
    - Low-level system components
      - System daemon : Systemd, runit, Networkd 등
      - Windows system : X11, Wayland, Mir SurfaceFlinger(Android) 등
      - Graphic : Mesa, AMD Catalyst 등
      - 그 외 라이브러리 : GTK+, Qt, SDL 등
    - C Standard library : glibc(POSIX), uClibc(임베디드 시스템), bionic(Android) 등
  - 커널 모드
    - 리눅스 커널
      - 시스템 콜 인터페이스 : stat, splice, dup,read, open 등
      - 프로세스 스케줄링 subsystem
      - IPC subsystem
      - 메모리 관리 subsystem
      - Virtual files subsystem
      - 네트워크 subsystem
      - 그 외 : ALSA, LVM, Linux Network Scheduler, LSM(Linux security module), TOMOYO 등



### 하드웨어 구성

1. MMU(Memory Management Unit)

   - CPU가 16비트에서 32비트로 전환되는 시기에 개발됨

   - 각 프로그램이 갖는 메모리 공간을 관리하면서 CPU의 기능을 최대한 활용하기 위한 것

   - 가상 주소 공간과 물리 주소 공간으로 나뉨

     - 가상 주소 공간 : CPU가 다룰 수 있는 32비트 공간

     - 물리 주소 공간 : 실제 하드웨어가 장착한 메모리 용량을 취급하는공간

   - MMU는 가상 주소 공간을 물리 주소 공간으로 변환하는 기능이 있다.

   - 물리적 공간에서는 페이지라는 단위로 나누어 프로세스마다 메모리를 할당한다.

   - 가상 공간에서는 각 프로그램이 동작하기 위해 메모리 공간이 할당되고 프로그램이 전환할 때 가상 공간이 바뀐다. 즉, `Context Switch`가 발생함

   - 이렇게 각 프로세스마다 가상공간에 메모리를 할당함으로써 서로 다른 프로그램들의 잘못된 액세스로 인한 오류를 방지할 수 있다.



### 소프트웨어 구성

1. 리눅스 커널
   - 스택 - 하드웨어를 추상적으로 이용하기 위한 것
     - 하드웨어 제어를 위한 장치 드라이버
     - 네트워크 프로토콜
     - 파일 시스템
   - 스케줄러
   - 메모리 관리
   - 커널은 물리 공간에서 동작
2. 그 외 소프트웨어
   - 커널이 제공하는 추상 인터페이스를 사용하기 위한 라이브러리
   - 프로세스 간 통신을 위한 라이브러리
   - 기동 순서 등을 제어하는 상주 소프트웨어(데몬)
   - GUI 제어하는 윈도우 관리자
   - 소프트웨어는 가상공간에서 동작하는데 이를 사용자 공간이라고 불림



### Process

- Linux 운영체제가 관리하는 실행 프로그램의 단위
- 하나의 프로세스는 가상 공간에서 하나의 메모리 공간을 가짐
- 서로 다른 프로세스 간 변수 접근 불가
- PID로 관리됨
- 부모와 자식 프로세스 관계로 생성됨.



### Thread

- 프로세스 내 처리 단위
- 프로그램 처리의 병렬성 향상
- 부모-자식 관계 없음
- 프로세스의 정보는 공유



### IPC

- Inter Process Communication
- 프로세스 들이 메모리 간 액세스와 처리를 위한 통신
- 시그널, 파이프, FIFO, 세마포어, 메시지 큐, 소켓, 공유메모리 등의 종류가 있다.



### 커널

- 시스템 전체 스케줄 관리

  - 프로세스 단위로 스케줄링

- 장치 드라이버

  - 하드웨어 추상화

  - 사용자 공간의 처리 요청과 하드웨어에 통지를 실시

  - 캐릭터형 장치

    - Byte Stream을 취급해 순차적으로 읽고 쓰는 장치
    - 하드디스크 제어에 적합하지는 않음

    - 예) 디스플레이, 프린터, USB 시리얼

  - 블록형 장치

    - 고정된 크기의 블록을 랜덤으로 읽고 쓰는 장치
    - CPU와 속도 차이가 있는 장치에 적합함

    - 예) 하드디스크, CD 드라이브, SD 카드

  - 네트워크형 장치

    - 소켓 인터페이스를 통해 통신하는 장치
    - 프로토콜 스택의 제어에 의존
    - 데이터 수신시 인터럽트 발생
    - 예) Ethernet, Wifi

- 커널 관련 소스 코드 디렉터리

  - arch
  - block
  - cryto
  - drivers
  - fs
  - init
  - ipc
  - kernel
  - mm
  - net
  - sound
  - include



### System Call Interface

-  시스템 콜 인터페이스는 사용자 공간에서 실행되는 프로세스나 라이브러리가 커널의 기능을 사용할 경우의 인터페이스이다.
- 300 종류가 있다.
- 장치 파일(/dev)
  - 사용자 공간의 프로세스에서 open, read/write 함수 등 시스템 콜을 사용하여 장치 드라이버에 액세스 하는데 사용됨
- 시스템 파일(/sys)
  - 사용자 공간의 프로세스에서 장치의 상태나 설정 변경 등이 가능한 장치 파일
- 시스템 상태 확인(/proc)
  - 사용자 공간의 프로세스 상태 및 커널의 설정 상태, 하드웨어 상태 등 다양한 상태를 확인할 수 있음

